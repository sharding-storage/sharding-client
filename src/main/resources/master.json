{ "openapi": "3.0.1","info": { "title": "Sharding Service API","description": "API для мастер-ноды шардированного хранилища","version": "1.0.0" },"servers": [ { "url": "http://localhost:8080","description": "Generated server url" } ],"tags": [ { "name": "Health check","description": "Health check" },{ "name": "main","description": "API мастер-узла" } ],"paths": { "/shards": { "put": { "tags": [ "main" ],"summary": "Обновить количество шардов","description": "Изменить число шардов в кластере","operationId": "updateShards","requestBody": { "content": { "application/json": { "schema": { "$ref": "#/components/schemas/ChangeShardRequest" } } },"required": true },"responses": { "200": { "description": "OK","content": { "*/*": { "schema": { "$ref": "#/components/schemas/CommonResponse" } } } } } } },"/scheme": { "get": { "tags": [ "main" ],"summary": "Обновить схему","description": "Получить схему узлов","operationId": "refreshSchema","responses": { "200": { "description": "OK","content": { "*/*": { "schema": { "$ref": "#/components/schemas/SchemaResponse" } } } } } },"post": { "tags": [ "main" ],"summary": "Добавить узел","description": "Добавить новый узел в шардирующий пул","operationId": "addNode","requestBody": { "content": { "application/json": { "schema": { "$ref": "#/components/schemas/NodeRequest" } } },"required": true },"responses": { "200": { "description": "OK","content": { "*/*": { "schema": { "$ref": "#/components/schemas/CommonResponse" } } } } } } },"/health": { "get": { "tags": [ "Health check" ],"summary": "Health check","description": "Проверка работоспособности сервиса","operationId": "healthCheck","responses": { "200": { "description": "OK","content": { "*/*": { "schema": { "type": "string" } } } } } } },"/scheme/{server}": { "delete": { "tags": [ "main" ],"summary": "Удалить узел","description": "Удалить узел из шардирующего пула","operationId": "removeNode","parameters": [ { "name": "server","in": "path","required": true,"schema": { "type": "string" } } ],"responses": { "200": { "description": "OK","content": { "*/*": { "schema": { "$ref": "#/components/schemas/CommonResponse" } } } } } } } },"components": { "schemas": { "ChangeShardRequest": { "required": [ "shardCount" ],"type": "object","properties": { "shardCount": { "type": "integer","description": "Новое количество шардов","format": "int32","example": 4 } },"description": "Новая конфигурация количества шардов в кластере" },"CommonResponse": { "type": "object","properties": { "answer": { "type": "string","description": "Сообщение ответа","example": "done" },"version": { "type": "integer","description": "Версия схемы","format": "int32","example": 1 } },"description": "Общий ответ сервера" },"NodeRequest": { "required": [ "address" ],"type": "object","properties": { "address": { "type": "string","description": "Сетевой адрес узла","example": "http://192.168.1.10:8000" } },"description": "Новая конфигурация количества шардов в кластере" },"SchemaResponse": { "type": "object","properties": { "nodes": { "type": "array","description": "Список адресов узлов","example": [ "NODE1 ADDRESS","NODE2 ADDRESS" ],"items": { "type": "string","description": "Список адресов узлов","example": "[\"NODE1 ADDRESS\",\"NODE2 ADDRESS\"]" } },"virtualNodes": { "type": "integer","format": "int32" },"version": { "type": "integer","format": "int32" } },"description": "Схема узлов в порядке хеширования" } } } }